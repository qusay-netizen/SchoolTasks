<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>موقع الأهل</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <a href="index.html" class="top-link">صفحة المعلمين</a>
</header>

<h2>جدول درجات الطلاب</h2>
<label>اختر الطالب:</label>
<select id="studentSelect" onchange="updateTestTable()"></select>
<table id="testTable"></table>

<footer>من تنفيذ: قصي الضريبي</footer>

<script>
let tests = [];
let studentsList = [];

window.onload = function() {
  const savedTests = localStorage.getItem('tests');
  const savedStudents = localStorage.getItem('studentsList');
  if (savedTests) tests = JSON.parse(savedTests);
  if (savedStudents) studentsList = JSON.parse(savedStudents);
  updateStudentSelect();
}

function updateStudentSelect() {
  const select = document.getElementById('studentSelect');
  select.innerHTML = '';
  studentsList.forEach(s => {
    const option = document.createElement('option');
    option.value = s;
    option.text = s;
    select.add(option);
  });
  updateTestTable();
}

function updateTestTable() {
  const selectedStudent = document.getElementById('studentSelect').value;
  const table = document.getElementById('testTable');
  table.innerHTML = '<tr><th>المادة</th><th>نوع الاختبار</th><th>درجة 40</th><th>درجة 30</th><th>ملاحظة المعلم</th></tr>';
  tests.forEach(t => { 
    if(t.student === selectedStudent){ 
      const row = table.insertRow(); 
      row.insertCell(0).innerText = t.testName; 
      row.insertCell(1).innerText = t.testType==='نهائي' ? 'الاختبار النهائي' : t.testType; 
      row.insertCell(2).innerText = t.testScore+'/40'; 
      row.insertCell(3).innerText = t.finalScore !== null ? t.finalScore+'/30':'-'; 
      row.insertCell(4).innerText = t.teacherNote; 
    } 
  });
}
</script>

</body>
</html>
